allprojects { p ->
    task publish {}
}

subprojects { s ->
    task buildImage(type:Exec, dependsOn:['build']) {
        // Docker build command
        commandLine 'docker', 'build', '-t', s.name, '.'

        //store the output instead of printing to the console
        standardOutput = new ByteArrayOutputStream()

        // Set working directory to project in order to find Dockerfile
        workingDir s.projectDir
    }
}